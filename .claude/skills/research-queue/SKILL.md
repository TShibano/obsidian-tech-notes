---
name: research-queue
description: GitHub Issue のチェックリストから調査項目を読み取り、順次技術ノートを作成する
user-invocable: true
---

# Research Queue 処理

GitHub Issue に記載された調査項目を順次処理し、`Notes/` に技術ノートを作成します。

## 使用方法

```
/research-queue [issue番号] [最大処理数]
```

- `issue番号`: 省略時は Issue #1 を使用
- `最大処理数`: 省略時は 3（コンテキスト制限を考慮）

**例:**
- `/research-queue` → Issue #1 から最大3件処理
- `/research-queue 1 5` → Issue #1 から最大5件処理
- `/research-queue 2` → Issue #2 から最大3件処理

## 処理手順

### 1. 引数の解析

`$ARGUMENTS` を解析して Issue 番号と最大処理数を取得:

- 第1引数: Issue 番号（省略時は 1）
- 第2引数: 最大処理数（省略時は 3）

**例:**
- `(空)` → Issue #1、最大3件
- `2` → Issue #2、最大3件
- `1 5` → Issue #1、最大5件

### 2. Issue の読み取り

`gh issue view <番号> --json body` コマンドで Issue 本文を取得する。

### 3. チェックリストのパース

Issue 本文からチェックリスト形式の行を抽出:

- `- [ ]` で始まる行を **未完了項目** として抽出
- `- [x]` または `- [X]` で始まる行は **完了済み** としてスキップ

各行から以下を抽出:
- **トピック名**: チェックボックスの直後のテキスト
- **フォーカス指示**: 括弧 `()` 内のテキスト（省略可）

**パース例:**
| 行 | トピック名 | フォーカス指示 |
|----|------------|----------------|
| `- [ ] Transformer` | Transformer | なし |
| `- [ ] RAG (実装パターンとベクトルDBの選択基準)` | RAG | 実装パターンとベクトルDBの選択基準 |
| `- [x] Docker` | (スキップ) | - |

### 4. 各項目の処理

未完了項目を最大処理数まで順次処理:

#### 4.1 既存ノートの確認

- `Notes/{トピック名}.md` が既に存在するか確認
- 存在する場合: その項目はスキップし、次の項目へ進む（Issue からも削除しない）

#### 4.2 WebSearch による調査

以下の4観点で WebSearch を実行し、情報を収集:

1. **基本概念**: トピックの定義、歴史、背景
2. **フォーカス内容**: フォーカス指示に沿った詳細情報（指示がある場合）
3. **最新動向**: 最新バージョン、最近の発表、トレンド
4. **実践例**: ユースケース、ベストプラクティス、実装例

**注意事項:**
- 一次情報源を優先する（公式ドキュメント、公式ブログ、論文など）
- まとめ記事経由の情報は追加検索で一次情報源を特定する

#### 4.3 タグの選定

以下のタグ体系に基づいて、親タグ+サブタグを付与:

| 親タグ | サブタグ例 |
|--------|-----------|
| `AI` | `LLM`, `ML`, `Agent`, `NLP`, `ComputerVision` |
| `Web` | `Frontend`, `Backend`, `API`, `Framework` |
| `Cloud` | `AWS`, `GCP`, `Azure`, `K8s`, `Serverless` |
| `DevOps` | `CI/CD`, `IaC`, `Monitoring` |
| `Security` | `Auth`, `Encryption`, `ZeroTrust` |
| `DB` | `SQL`, `NoSQL`, `VectorDB` |
| `Language` | `Python`, `TypeScript`, `Go`, `Rust` |
| `Tool` | `Git`, `Editor`, `CLI` |

#### 4.4 ノートの作成

`Templates/tech-note.md` のテンプレート構造に従って日本語でノートを作成:

```yaml
---
title: "トピック名"
date: YYYY-MM-DD
tags:
  - 親タグ
  - サブタグ
related:
  - "[[関連ノート]]"
---
```

**セクション構成:**
- **概要**: トピックの簡潔な説明（1-3文）
- **詳細**: トピックの詳細な解説。フォーカス指示がある場合はその内容を重点的に記述
- **ポイント**: 重要な点を箇条書きで整理
- **関連項目**: 関連する既存ノートへの `[[ノート名]]` リンク
- **参考**: 調査で使用した一次情報源へのリンク

#### 4.5 双方向リンクの整合性維持

関連ノートとしてリンクした既存ノートに対して、逆リンクを追加:

1. リンク先ノートの `related` frontmatter に `"[[今回のトピック名]]"` を追加
2. リンク先ノートの「関連項目」セクションに `- [[今回のトピック名]]` を追加

**注意**: 既に逆リンクが存在する場合は追加しない

#### 4.6 処理完了の記録

処理が完了した項目を内部リストに記録する。

### 5. Issue の更新

すべての処理が完了したら、Issue を更新:

1. 処理完了した項目のチェックリスト行を Issue 本文から削除する
2. `gh issue edit <番号> --body "..."` で Issue 本文を更新

**重要**:
- 1項目でも処理が完了していれば、その分だけ Issue を更新する
- 処理に失敗した項目は `- [ ]` のまま残す

### 6. コミットとプッシュ

処理が1件以上完了している場合、変更をコミットしてリモートにプッシュする:

1. 新規作成したノートファイルと逆リンクを追加した既存ノートファイル（`Notes/` 配下）を `git add` でステージング
2. 以下の形式でコミットメッセージを作成し `git commit` する:
   - 形式: `技術調査(YYYY/MM/DD): トピック1, トピック2, ...`
   - 例: `技術調査(2026/02/10): Transformer, RAG, Docker`
3. `git push` でリモートにプッシュ

**注意**: 1件も処理が完了していない場合はコミット・プッシュを行わない

### 7. 結果報告

処理結果をユーザーに報告:

```
## 処理結果

**処理完了**: X 件
- [[トピック1]] - フォーカス指示（あれば）
- [[トピック2]]

**スキップ**: Y 件（既存ノートあり）
- トピック3

**残り未処理**: Z 件
```

## エラーハンドリング

- Issue が存在しない場合: エラーメッセージを表示して終了
- Issue にチェックリストがない場合: その旨を報告して終了
- 未完了項目がない場合: 「すべての項目が完了済みです」と報告して終了
- 個別項目の処理失敗: エラーをログに記録し、次の項目へ進む（完了分は Issue に反映）
