---
title: "jujutsu"
date: 2026-02-07
tags:
  - Tool
  - Git
related:
  - "[[Rust]]"
---

## 概要

jujutsu（jj）は Git 互換の次世代バージョン管理システムで、[[Rust]] で実装されている。Git のストレージバックエンドをそのまま利用しつつ、データモデルと CLI を根本から再設計することで、Git の複雑さを解消しながら強力な機能を提供する。

## 詳細

### 背景と歴史

jujutsu は Google のエンジニア Martin von Zweigbergk によって開発が開始された。Google 社内の VCS（Piper）や Mercurial の設計思想を取り入れつつ、Git エコシステムとの互換性を保つことを重視している。2024年12月に GitHub リポジトリが `jj-vcs` オーガニゼーションに移行し、コミュニティ主導の開発体制が強化された。

### コアコンセプト

#### ワーキングコピー＝コミット

jj では作業ディレクトリの状態が常にコミットとして扱われる。ファイルを編集するたびに自動的にスナップショットが取られ、現在のコミットが更新される。これにより Git のステージング領域（index）が不要になり、`git add` のような操作なしに変更が追跡される。

#### ステージング不要のモデル

Git のインデックス（ステージングエリア）は完全に排除されている。変更を分割したい場合は `jj split`、統合したい場合は `jj squash` を使う。これにより「add し忘れてコミットに含まれなかった」といった問題が発生しない。

#### 匿名ブランチ

jj ではブランチ名（jj では「ブックマーク」と呼ぶ）を付けずに作業できる。コミットグラフのすべての可視ヘッドが追跡されるため、名前がなくてもコミットが失われたりガベージコレクションされたりしない。GitHub 等で PR を作成する場合はブックマークを使うが、トランクベース開発や Gerrit を使うワークフローでは不要。

#### ファーストクラスのコンフリクト

Git ではコンフリクトが発生するとすぐに解決が求められるが、jj ではコンフリクトをコミットとして保存できる。コンフリクトを含むコミットに対してリベースや編集を行い、後から解決することが可能。解決結果は子孫コミットに自動的に伝搬する。

#### オペレーションログ

jj はリポジトリに対するすべての操作（コミット、プル、プッシュなど）を記録する。Git の reflog と異なり、リベースなどの複雑な操作も単一のアトミックなエントリとして記録される。`jj undo` コマンドで任意の操作を安全に取り消せる。

#### 自動リベース

コミットを書き換えると、その子孫コミットが自動的にリベースされる。ブックマークやワーキングコピーも追従するため、手動でのリベース操作が大幅に減る。

### Git との主な違い

| 観点 | Git | jujutsu |
|------|-----|---------|
| ステージング | `git add` でインデックスに追加 | 不要（自動スナップショット） |
| ブランチ | 必須、名前付き | 任意（ブックマーク）、匿名ブランチ可 |
| コンフリクト | 即時解決が必要 | コミットとして保存可能 |
| 操作の取り消し | `git reflog` + 手動復元 | `jj undo` で一発 |
| 子孫の更新 | 手動リベースが必要 | 自動リベース |
| ワーキングコピー | コミットとは別の状態 | 常にコミットとして扱われる |
| ストレージ | Git 独自 | Git をバックエンドとして利用 |

### Git との互換性

jj は内部で Git リポジトリをストレージバックエンドとして使用するため、既存の Git ツール（GitHub、GitLab、IDE 連携など）とシームレスに連携できる。同じワーキングコピーで jj と Git を併用することも可能で、チームメンバーが Git を使い続けていても影響がない。

### 最新動向（2026年）

- **zlib-rs** の採用により圧縮処理が高速化
- ドキュメントが `docs.jj-vcs.dev` に移行
- 並行操作時の競合状態（colocated リポジトリ）が修正され、安全性が向上
- ファイルセットやパスパターンでのグロブマッチングがデフォルトで有効に
- `jj file annotate`（`git blame` 相当）の追加（v0.24）

## ポイント

- Git のストレージバックエンドをそのまま利用するため、既存の Git エコシステムと完全互換
- ステージング不要・自動スナップショットにより、Git より大幅にシンプルなワークフロー
- ファーストクラスのコンフリクト処理で、コンフリクトを含むコミットの操作が可能
- オペレーションログと `jj undo` により、あらゆる操作を安全に取り消し可能
- 匿名ブランチにより、ブランチ管理の手間を削減
- ロックインがなく、いつでも Git に戻れる

## 関連項目

- [[Rust]] - jujutsu の実装言語

## 参考

- [jj-vcs/jj - GitHub](https://github.com/jj-vcs/jj)
- [Jujutsu docs](https://docs.jj-vcs.dev/latest/)
- [Git comparison - Jujutsu docs](https://docs.jj-vcs.dev/latest/git-comparison/)
- [Steve's Jujutsu Tutorial](https://steveklabnik.github.io/jujutsu-tutorial/)
- [jj init — Chris Krycho](https://v5.chriskrycho.com/essays/jj-init/)
- [Jujutsu in practice - arne.me](https://arne.me/blog/jj-in-practice)
